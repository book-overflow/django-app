{% extends 'base.html' %}

{% block content %}
<div class="container" style="text-align: center; max-width: 800px; margin: auto; background-color: #f9f9f9; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
    <h2 style="color: #333; margin-bottom: 20px;">Your Conversations</h2>

    {% if conversations %}
    <div style="margin-bottom: 20px;">
        {% for conversation in conversations %}
        <div style="background-color: #fff; margin-bottom: 10px; padding: 15px; border-radius: 4px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <a href="{% url 'view_conversation' conversation.id %}" style="text-decoration: none; color: #0056b3;">
                Conversation with {% for user in conversation.participants.all %}
                {% if user != request.user %}
                {{ user.email }} {{ user.last_name }}
                {% endif %}
                {% endfor %}
            </a>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p>No conversations yet.</p>
    {% endif %}

    <!-- Form to start a new conversation -->
    <h3 style="margin-bottom: 10px;">Start a New Conversation</h3>
    <form action="{% url 'start_conversation' %}" method="post" style="background-color: #fff; padding: 20px; border-radius: 4px; border: 1px solid #ccc;">
        {% csrf_token %}
        <select name="user_id" class="form-control" style="margin-bottom: 10px;">
            {% for user in users %}
            <option value="{{ user.id }}">{{ user.first_name }} {{ user.last_name }}</option>
            {% endfor %}
        </select>
        <button type="submit" class="btn btn-primary">Start Conversation</button>
    </form>
</div>
{% endblock %}
